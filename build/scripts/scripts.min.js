var weatherApp=angular.module("weatherApp",["ngRoute","ngResource"]);weatherApp.service("cityService",function(){this.city="New York, NY"}),weatherApp.controller("forecastController",["$scope","$resource","cityService","$routeParams",function(e,t,o,r){e.city=o.city,e.days=r.days||2,e.weatherAPI=t("http://api.openweathermap.org/data/2.5/forecast/daily",{callback:"JSON_CALLBACK"},{get:{method:"JSONP"}}),e.weatherResult=e.weatherAPI.get({q:e.city,cnt:e.days,APPID:"3ca4cb682481154e17368d817de04cb4",units:"metric"}),e.convertToFahrenheit=function(e){return Math.round(e)},e.convertToDate=function(e){return new Date(1e3*e)},console.log(e.weatherResult)}]),weatherApp.controller("homeController",["$scope","cityService",function(e,t){$("input").keyup(function(){$("#city").val()<1?($("#alert").html("Please enter a city"),$("#alert").addClass("alert alert-danger"),$("#getForecastBtn").attr("disabled","disabled")):($("#alert").html(" "),$("#getForecastBtn").removeAttr("disabled"),$("#alert").removeClass("alert alert-danger"))}),e.city=function(){},e.city=t.city,e.getLocation=function(){function t(){n=new google.maps.Geocoder}function o(t,o){var r=new google.maps.LatLng(t,o);n.geocode({latLng:r},function(t,o){if(o==google.maps.GeocoderStatus.OK)if(console.log(t),t[1]){console.log(t[3].formatted_address),e.city=t[3].formatted_address,$("#alert").html(" "),$("#getForecastBtn").removeAttr("disabled"),$("#alert").removeClass("alert alert-danger");for(var r=0;r<t[0].address_components.length;r++)for(var a=0;a<t[0].address_components[r].types.length;a++)if("administrative_area_level_1"==t[0].address_components[r].types[a]){city=t[0].address_components[r];break}console.log("city "+city),console.log(city.short_name+" "+city.long_name)}else alert("No results found");else alert("Geocoder failed due to: "+o)})}navigator.geolocation?(console.log("Geolocation is supported!"),t()):console.log("Geolocation is not supported for this Browser/OS version yet.");var r,a=function(e){r=e,console.log(e.coords.latitude),o(e.coords.latitude,e.coords.longitude),o(e.coords.latitude,e.coords.longitude)};navigator.geolocation.getCurrentPosition(a);var n},e.getLocation(),e.$watch("city",function(){t.city=e.city}),document.getElementById("city").innerHTML=e.city}]),weatherApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"home.htm",controller:"homeController"}).when("/forecast",{templateUrl:"forecast.htm",controller:"forecastController"}).when("/forecast/:days",{templateUrl:"forecast.htm",controller:"forecastController"})}]);